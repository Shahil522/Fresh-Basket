<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account</title>
</head>
<body>
    <h1>My Account</h1>
    <p>Name: <span id="userName"></span></p>
    <p>Email: <span id="userEmail"></span></p>
    <p>Phone: <span id="userPhone"></span></p>
    <p>Address: <span id="userAddress"></span></p>
    <button id="logoutBtn">Log Out</button>

    <h2>Order History (Coming Soon)</h2>
    <div id="orders"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBWqcmP4_q0dxTtfkMkPKi6EvS61Ghk42s",
            authDomain: "fresh-basket-e05c0.firebaseapp.com",
            projectId: "fresh-basket-e05c0",
            storageBucket: "fresh-basket-e05c0.firebasestorage.app",
            messagingSenderId: "827276656041",
            appId: "1:827276656041:web:f400f9bcc6b71b39b058b8",
            measurementId: "G-FDWJGSH7FR"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Check if user is logged in
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const docRef = doc(db, "users", user.uid);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    document.getElementById('userName').innerText = data.name;
                    document.getElementById('userEmail').innerText = data.email;
                    document.getElementById('userPhone').innerText = data.phone;
                    document.getElementById('userAddress').innerText = data.address;
                } else {
                    alert("No user profile found.");
                }
            } else {
                window.location.href = "sign-in.html";
            }
        });

        // Log out
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            await signOut(auth);
            window.location.href = "sign-in.html";
        });
    </script>
</body>
</html>
